@{
    ViewBag.Title = "Upload Document And Data";
    Layout = null;
}
@model  Synzeal_Inventory.Entity.SZ_QuotationDetail


<!-- left column -->
<div class="col-md-12">
    <!-- general form elements -->
    <div class="box box-primary">
        <form role="form" id="formuploaddoc">
            <div class="box-body">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="exampleInputEmail1">GLP Stability : </label>
                        <span><input type="file" class="form-control" id="GLPStabilityPath" name="GLPStabilityPath" /></span>
                        <input type="hidden" id="Id" name="Id" value="@Model.Id" />
                        <input type="hidden" id="delcoa" name="delcoa" value="false" />
                        @if (!string.IsNullOrEmpty(Model.GLPStabilityPath))
                        {
                            <div id="divdelcoa">
                                <a href="@Model.GLPStabilityPath">Download</a> @*<span> | </span> <a href="jaavscript:void(0)" style="color:red" onclick="delcoafn()">Delete</a>*@
                            </div>
                        }
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1">GLP AMV : </label>
                        <span><input type="file" class="form-control" id="GLPAMVPath" name="GLPAMVPath" /></span>
                        <input type="hidden" id="deldata" name="deldata" value="false" />
                        @if (!string.IsNullOrEmpty(Model.GLPAMVPath))
                        {
                            <div id="divdeldata">
                                <a href="@Model.GLPAMVPath">Download</a> @*<span> | </span> <a href="jaavscript:void(0)" style="color:red" onclick="deldatafn()">Delete</a>*@
                            </div>
                        }
                    </div>
                </div>
                <div class="form-group" style="text-align:right">
                    <button type="button" onclick="uploadglpdata()" class="btn btn-primary">Save</button>
                </div>
            </div>
        </form>
    </div>
</div>
<div class="clearfix"></div>
<script>
    $.fn.serializeObject = function () {
        var o = {};
        var a = this.serializeArray();
        $.each(a, function () {
            if (o[this.name]) {
                if (!o[this.name].push) {
                    o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
            } else {
                o[this.name] = this.value || '';
            }
        });
        return o;
    };
    function uploadglpdata() {
        $(".errorcls").each(function () {
            $(this).removeClass('errorcls');
        });

        var errorCount = 0;
        var address = ""; //$("#address").val()
        var model = $("#formuploaddoc").serializeObject();

        var formData = new FormData();
        var file = document.getElementById("GLPStabilityPath").files[0];
        var GLPAMVPath = document.getElementById("GLPAMVPath").files[0];
        formData.append("Id", $("#Id").val());
        formData.append("GLPStabilityPath", file);
        formData.append("GLPAMVPath", GLPAMVPath);
        formData.append("delcoa", $("#delcoa").val());
        formData.append("deldata", $("#deldata").val());
        $.ajax({
            type: "POST",
            url: "/Form/UploadGLPDataQuotedetails",
            data: formData,
            dataType: 'json',
            contentType: false,
            processData: false,
            success: function (results) {
                if(results === "Success")
                {
                    $("#myModal").modal('hide');
                    $("#myModal").find(".modal-body").html("");
                    toastr.success("Information Saved Successfully.");
                    $('#tblglp').DataTable().ajax.reload(null, false);
                }
            }
        });


        //$.ajax({
        //    type: "POST",
        //    url: "/Form/UploadDocumentQuotedetails",
        //    data: $("#formuploaddoc").serializeObject(),
        //    success: function (results) {
        //        if (!results.success) {
        //            swal("Opps!", results.message, "error");
        //            return false;
        //        }
        //        swal("Good job!", "Representative COA generated.", "success");
        //        setTimeout(function () {
        //            ReloadChildMaster();
        //            $('#myModal').modal('hide');
        //        }, 2000);

        //    }
        //});
    }


    function delcoafn() {
        $('#delcoa').val('true');
        $('#divdelcoa').hide();
    }
    function deldatafn() {
        $('#deldata').val('true');
        $('#divdeldata').hide();
    }
</script>
