@{
    ViewBag.Title = "PR Request List";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model IEnumerable<Synzeal_Inventory.Entity.SZ_PRRequest>
@using Synzeal_Inventory.Models
<section class="content-header">
    <h1>
        PR Request List <a style="float:right" class="btn btn-primary" href="@Url.Action("PRRequest","Form")">Create PR</a>
    </h1>
</section>
<section class="content">
    <div class="row">
        <div class="col-xs-12">
            <div class="box box-primary">
                <!-- /.box-header -->
                <div class="box-body">
                    <div style="padding-bottom:10px;">
                        <input type="radio" name="fltopenclose" value="open" checked /> Open
                        <input type="radio" name="fltopenclose" value="close" /> Close
                    </div>
                    <div class="clearfix"></div>
                    <table id="example1" style="width:100%" class="table table-condensed table-striped table-bordered  table-hover" cellspacing="0">
                        <thead>
                            <tr>
                                <th></th>
                                <th>#</th>
                                <th>Date of PR</th>
                                <th>
                                    PR Raise By
                                </th>
                                <th>
                                    Team Leader
                                </th>
                                <th>
                                    Lab No
                                </th>
                                <th>
                                    Status
                                </th>
                                <th>
                                    Project Name
                                </th>
                                <th>
                                    Material Name
                                </th>
                                <th>
                                    CAS
                                </th>
                                <th>
                                    SZ-CAT

                                </th>
                                <th>
                                    MW
                                </th>
                                <th>
                                    MF
                                </th>
                                <th>
                                    Total Qty
                                </th>
                                <th>
                                    Pack Size
                                </th>
                                <th>
                                    No of Pack
                                </th>
                                <th>
                                    UoM
                                </th>
                                <th>
                                    Received Quotation
                                </th>
                                <th>
                                    Make
                                </th>
                                <th>
                                    Supplier Ref Cat/Link
                                </th>
                                <th>
                                    Density
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int loop = 1;
                            }
                            @foreach (var i in Model)
                            {
                                string clsopenclose = "";
                                if (i.IsRequestClosed == true)
                                {
                                    clsopenclose = "clsclose";
                                }
                                else
                                {
                                    clsopenclose = "clsopen";
                                }
                                <tr class="@clsopenclose">
                                    <td>
                                        <a href="@Url.Action("PRRequest","Form",new { id = i.Id})"> Edit</a> |
                                        <a href="javascript:void(0)" onclick="deletePRRequest('@i.Id')"> Delete</a>
                                    </td>
                                    <td>@loop</td>
                                    <td>@i.CreatedDate.ToShortDateString()</td>
                                    <td>@i.RaisedBy</td>
                                    <td>@i.SubscientistName</td>
                                    <td>Lab @i.Labno</td>
                                    <td>
                                        @{
                                            string strrr = "";
                                            foreach (EnumList.PRRequestStatus r in Enum.GetValues(typeof(EnumList.PRRequestStatus)))
                                            {
                                                var items = Enum.GetName(typeof(EnumList.PRRequestStatus), r);
                                                var test = r.ToString();
                                                string text = SZ_Helper.GetEnumDescription((EnumList.PRRequestStatus)(int)r);
                                                int val = (int)r;
                                                if (val == i.Status)
                                                {
                                                    strrr = text;
                                                }
                                            }
                                            @strrr
                                        }
                                    </td>
                                    <td>@i.APIName</td>
                                    <td>@i.ProductName</td>
                                    <td>@i.CASNo</td>
                                    <td>@i.CATNo</td>
                                    <td>@i.MolWeight</td>
                                    <td>@i.MolFormula</td>
                                    <td>@i.TotalQty</td>
                                    <td>@i.PackSize</td>
                                    <td>@i.NoofPack</td>
                                    <td>@i.UoM</td>
                                    <td>@i.ReceivedQuotation</td>
                                    <td>@i.Make</td>
                                    <td>@i.SupplierRef</td>
                                    <td>@i.Density</td>
                                </tr>
                                loop += 1;
                            }
                        </tbody>
                    </table>
                </div>
                <!-- /.box-body -->
            </div>
        </div>
    </div>
</section>
<style>
    .clsclose{
        display:none;
    }
    .clsblock {
        background: #5c5c5c !important;
        color: #fff;
    }

    #myModal .modal-content {
        width: 1200px;
    }

    #myModal .modal-dialog {
        width: 1200px;
    }
</style>
<script>

    $('input[type=radio][name=fltopenclose]').change(function () {
        if (this.value == 'open') {
            $('.clsclose').css('display', 'none');
            $('.clsopen').css('display', 'contents');
        }
        else if (this.value == 'close') {
            $('.clsopen').css('display', 'none');
            $('.clsclose').css('display', 'contents');
        }
    });

    $(function () {
        var alltbl = $('#example1').DataTable({
            "searching": true,
            "ordering": false,
            "scrollX": true,
            "scrollY": "550px",
            //"sPaginationType": "listbox",
            //"autoWidth" : false,
            "processing": true, // for show progress bar
            "serverSide": false, // for process server side
            "pageLength": 25,
        });
    });

    function deleteCompany(id) {
        swal({
            title: "Are you sure?",
            text: "You will not be able to recover this PR Request!",
            type: "warning",
            showCancelButton: true,
            confirmButtonClass: "btn-danger",
            confirmButtonText: "Yes, delete it!",
            cancelButtonText: "No, cancel!",
            closeOnConfirm: true,
            closeOnCancel: true
        },
            function (isConfirm) {
                if (isConfirm) {
                    $.ajax({
                        type: "POST",
                        url: "/Form/DeletePRRequest?id=" + id,
                        data: {},
                        success: function (results) {
                            if (results.success) {
                                toastr.success("PR Request has been deleted.");
                                setTimeout(function () { window.location.reload(true); }, 2000);
                            }
                        }
                    });

                }
                else {
                    toastr.error('Your added quote is safe :).');
                }
            });
    }
</script>